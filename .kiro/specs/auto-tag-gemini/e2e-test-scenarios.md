# E2Eテストシナリオ詳細

## 目次

1. [ユーザージャーニーマップ](#ユーザージャーニーマップ)
2. [詳細テストケース](#詳細テストケース)
3. [ユーザーペルソナ](#ユーザーペルソナ)
4. [実行スクリプト](#実行スクリプト)

---

## ユーザージャーニーマップ

### 新規ユーザーのジャーニー

```
発見 → インストール → 設定 → 初回使用 → 結果確認 → 継続使用
  ↓        ↓          ↓        ↓          ↓          ↓
興味    簡単?      迷わない?  動く?    満足?      習慣化?
```

### 既存ユーザーのジャーニー

```
新規ノート作成 → Auto Tagger起動 → 処理実行 → 結果確認 → 次の作業
      ↓              ↓              ↓          ↓          ↓
   日常作業        すぐ起動       待ち時間    期待通り    効率化
```

---

## 詳細テストケース

### TC-E2E-001: 完全な初回セットアップフロー

**目的**: 新規ユーザーが初めてAuto Taggerを使用する完全なフローを検証

**ペルソナ**: 田中さん（新規ユーザー）

**シナリオ**:
田中さんは、Obsidianで200件以上のノートを管理していますが、タグ付けが追いついていません。Auto Taggerプラグインを見つけて、試してみることにしました。

**前提条件**:
- Obsidianがインストールされている
- 200件のノートがある（タグなし）
- Gemini API keyを取得済み
- プラグインをインストール済み

**詳細ステップ**:

1. **プラグインの有効化** (1分)
   ```
   操作: 設定 → Community plugins → Personal Context → Enable
   確認: プラグインが有効になる
   期待: リボンにタグアイコンが表示される
   ```

2. **API keyの設定** (2分)
   ```
   操作: 設定 → Personal Context → Gemini API Key入力
   確認: API keyが保存される
   期待: エラーメッセージが表示されない
   ```

3. **Auto Tagger設定** (3分)
   ```
   操作: Auto Tagger設定セクションで以下を設定
   - Target directory: "" (vault全体)
   - Exclude note tag: "processed"
   - Exclude suggestion tags: "meta, system"
   確認: 設定が保存される
   期待: 設定値が次回も保持される
   ```

4. **初回実行** (5分)
   ```
   操作: リボンアイコンをクリック → 「開始」ボタンをクリック
   確認:
   - 対象ノート数が表示される（例: 200件）
   - 進捗バーが表示される
   - ログがリアルタイムで更新される
   期待:
   - 処理が開始される
   - UIがフリーズしない
   - 進捗が明確に表示される
   ```

5. **処理の監視** (3-5分)
   ```
   操作: 処理を監視
   確認:
   - バッチ番号が増加（1→2→3...）
   - 現在処理中のノート名が表示される
   - 成功/失敗カウントが更新される
   期待:
   - スムーズに処理が進む
   - エラーが発生しない
   ```

6. **結果の確認** (3分)
   ```
   操作: 処理完了後、サマリーを確認
   確認:
   - 総ノート数: 200
   - 成功: 200（または適切な数）
   - 失敗: 0
   - 適用タグ総数: > 0
   期待:
   - サマリーが明確に表示される
   - 処理時間が表示される
   ```

7. **ノートの確認** (2分)
   ```
   操作: ランダムに5件のノートを開く
   確認:
   - frontmatterにtagsフィールドがある
   - 適切なタグが追加されている
   - 既存の内容が変更されていない
   期待:
   - 全てのノートにタグが追加されている
   - タグの内容が適切
   ```

8. **ログファイルの確認** (1分)
   ```
   操作: .obsidian/plugins/personal-context/logs/auto-tag.logを開く
   確認:
   - セッション開始が記録されている
   - 各ノートの処理結果が記録されている
   - サマリーが記録されている
   期待:
   - ログが読みやすい
   - 必要な情報が全て記録されている
   ```

**総所要時間**: 約20分

**成功基準**:
- ✅ 全ステップが迷わず実行できる
- ✅ エラーが発生しない
- ✅ 処理が正常に完了する
- ✅ ノートにタグが追加される
- ✅ ユーザーが満足する

**失敗パターン**:
- ❌ API keyの入力方法が分からない
- ❌ 設定項目の意味が分からない
- ❌ 処理が途中で止まる
- ❌ エラーメッセージが理解できない
- ❌ 結果が期待と異なる

---

### TC-E2E-002: 日常的な使用フロー（週次タグ付け）

**目的**: 定期的にノートにタグを付ける日常的なワークフローを検証

**ペルソナ**: 佐藤さん（既存ユーザー）

**シナリオ**:
佐藤さんは毎週末、その週に作成したノートにAuto Taggerでタグを付けています。今週は10件の新しいノートを作成しました。

**前提条件**:
- Auto Taggerの設定が完了している
- 今週作成した10件のノートがある
- 先週までのノートには`processed`タグがある

**詳細ステップ**:

1. **週次ルーティンの開始** (30秒)
   ```
   操作: 週末の作業として、Auto Taggerを起動
   確認: ビューが開く
   期待: すぐに起動する
   ```

2. **対象ノートの確認** (30秒)
   ```
   操作: 「開始」ボタンをクリック
   確認: 対象ノート数が10件と表示される
   期待: 今週のノートのみが対象
   ```

3. **処理の実行** (1-2分)
   ```
   操作: 処理を実行
   確認:
   - 2バッチで処理される（5件+5件）
   - 進捗が表示される
   期待: 迅速に完了する
   ```

4. **結果の確認** (1分)
   ```
   操作: サマリーを確認
   確認:
   - 成功: 10件
   - 失敗: 0件
   期待: 全て成功
   ```

5. **処理済みマーキング** (2分)
   ```
   操作: 処理したノートに`processed`タグを追加
   確認: 次回は対象外になる
   期待: 簡単にマーキングできる
   ```

**総所要時間**: 約5分

**成功基準**:
- ✅ 5分以内に完了する
- ✅ 迷わず操作できる
- ✅ 全てのノートが処理される
- ✅ ワークフローがスムーズ

---

### TC-E2E-003: 大規模プロジェクトの一括タグ付け

**目的**: 大量のノート（100件以上）を一括処理するフローを検証

**ペルソナ**: 山田さん（パワーユーザー）

**シナリオ**:
山田さんは新しいプロジェクトで150件のノートをインポートしました。これらに一括でタグを付けたいと考えています。

**前提条件**:
- 150件の新規ノートがある
- 処理に時間がかかることを理解している
- バックアップを取っている

**詳細ステップ**:

1. **処理前の準備** (5分)
   ```
   操作:
   - バックアップを取る
   - 処理時間を見積もる（150件で約3-5分）
   - コーヒーを用意する
   確認: 準備完了
   期待: 安心して処理を開始できる
   ```

2. **処理の開始** (1分)
   ```
   操作: Auto Taggerを起動して開始
   確認: 対象ノート数が150件と表示される
   期待: 正しい件数が表示される
   ```

3. **処理の監視** (5-7分)
   ```
   操作: 処理を監視しながら他の作業
   確認:
   - 進捗バーが更新される
   - バッチ番号が増加（1→2→...→30）
   - エラーがないか確認
   期待:
   - 安定して処理が進む
   - UIが応答し続ける
   ```

4. **途中での一時停止テスト** (オプション)
   ```
   操作: バッチ10で「停止」ボタンをクリック
   確認:
   - 現在のバッチが完了する
   - 部分的なサマリーが表示される
   期待: 適切に停止する
   ```

5. **処理の再開** (オプション)
   ```
   操作: 残りのノートを処理するため再度開始
   確認: 未処理のノートのみが対象
   期待: 重複処理されない
   ```

6. **完了後の検証** (5分)
   ```
   操作:
   - サマリーを確認
   - ログファイルを確認
   - ランダムに10件のノートを確認
   確認:
   - 全て処理されている
   - タグが適切
   - エラーがない
   期待: 全て成功
   ```

**総所要時間**: 約15-20分

**成功基準**:
- ✅ 大量のノートが正常に処理される
- ✅ パフォーマンスの問題がない
- ✅ 停止・再開が正しく動作する
- ✅ メモリリークがない

---

### TC-E2E-004: エラー発生時のリカバリーフロー

**目的**: エラーが発生した場合のユーザーの対処フローを検証

**ペルソナ**: 鈴木さん（中級ユーザー）

**シナリオ**:
鈴木さんは処理中にネットワークエラーが発生しました。適切に対処して処理を完了させる必要があります。

**詳細ステップ**:

1. **通常の処理開始** (1分)
   ```
   操作: 20件のノートを処理開始
   確認: 処理が開始される
   期待: 正常に開始
   ```

2. **エラーの発生** (シミュレーション)
   ```
   状況: バッチ2でネットワークエラーが発生
   確認:
   - エラーメッセージが表示される
   - 処理が停止する
   - エラーがログに記録される
   期待:
   - アプリがクラッシュしない
   - エラーメッセージが明確
   ```

3. **エラーの理解** (1分)
   ```
   操作: エラーメッセージを読む
   確認:
   - 何が問題か理解できる
   - 対処方法が分かる
   期待: ユーザーが次のアクションを判断できる
   ```

4. **問題の解決** (2分)
   ```
   操作: ネットワーク接続を確認・修復
   確認: 接続が復旧
   期待: 問題が解決される
   ```

5. **処理の再実行** (2分)
   ```
   操作: 「開始」ボタンを再度クリック
   確認:
   - 未処理のノートが対象になる
   - 処理が再開される
   期待:
   - 重複処理されない
   - 正常に完了する
   ```

6. **結果の確認** (1分)
   ```
   操作: 全てのノートが処理されたか確認
   確認:
   - 最初のバッチ（成功分）
   - 再実行分
   - 合計が正しい
   期待: 全て処理されている
   ```

**総所要時間**: 約10分

**成功基準**:
- ✅ エラーが適切に処理される
- ✅ ユーザーが対処方法を理解できる
- ✅ 再実行が簡単にできる
- ✅ データの整合性が保たれる

---

### TC-E2E-005: カスタマイズと最適化フロー

**目的**: ユーザーが自分のニーズに合わせて設定を最適化するフローを検証

**ペルソナ**: 高橋さん（上級ユーザー）

**シナリオ**:
高橋さんは技術ブログを書いており、技術的なタグを優先的に付けたいと考えています。

**詳細ステップ**:

1. **現状の確認** (2分)
   ```
   操作: デフォルト設定で5件のノートを処理
   確認: 提案されたタグを確認
   期待: 一般的なタグが提案される
   ```

2. **System Instructionのカスタマイズ** (3分)
   ```
   操作: 設定画面でSystem Instructionを編集
   入力: "技術ブログのノートです。プログラミング言語、フレームワーク、
         技術概念に関連するタグを優先的に提案してください。
         一般的なタグ（例: 'note', 'draft'）は避けてください。"
   確認: 保存される
   期待: カスタム指示が保存される
   ```

3. **除外タグの設定** (2分)
   ```
   操作: Exclude suggestion tagsを設定
   入力: "general, misc, note, draft, temp"
   確認: 保存される
   期待: これらのタグが提案されなくなる
   ```

4. **カスタマイズ後のテスト** (3分)
   ```
   操作: 同じ5件のノートを再処理（タグを削除してから）
   確認: 提案されたタグを確認
   期待:
   - 技術的なタグが増える
   - 除外タグが提案されない
   - より関連性の高いタグ
   ```

5. **結果の比較** (2分)
   ```
   操作: カスタマイズ前後のタグを比較
   確認:
   - Before: ["note", "draft", "programming", "web"]
   - After: ["javascript", "react", "frontend", "web-development"]
   期待: カスタマイズの効果が明確
   ```

6. **設定の微調整** (3分)
   ```
   操作: 必要に応じてSystem Instructionを調整
   確認: 満足のいく結果が得られるまで繰り返す
   期待: 柔軟にカスタマイズできる
   ```

**総所要時間**: 約15分

**成功基準**:
- ✅ カスタマイズが正しく反映される
- ✅ 効果が明確に確認できる
- ✅ 調整が簡単にできる
- ✅ ユーザーのニーズに合わせられる

---

### TC-E2E-006: マルチデバイス・マルチセッションフロー

**目的**: 複数のデバイスやセッションでの使用を検証

**ペルソナ**: 伊藤さん（モバイルユーザー）

**シナリオ**:
伊藤さんはデスクトップとモバイルでObsidianを使用しています。デスクトップでAuto Taggerを使用し、モバイルで結果を確認します。

**詳細ステップ**:

1. **デスクトップでの処理** (5分)
   ```
   操作: デスクトップで30件のノートを処理
   確認: 処理が完了
   期待: タグが追加される
   ```

2. **同期の確認** (2分)
   ```
   操作: Obsidian Syncまたはその他の同期方法で同期
   確認: 同期が完了
   期待: 変更が同期される
   ```

3. **モバイルでの確認** (3分)
   ```
   操作: モバイルデバイスでObsidianを開く
   確認:
   - ノートにタグが追加されている
   - frontmatterが正しく表示される
   期待: デスクトップと同じ状態
   ```

4. **モバイルでの追加作業** (2分)
   ```
   操作: モバイルで新しいノートを作成
   確認: ノートが作成される
   期待: 次回デスクトップで処理できる
   ```

5. **デスクトップでの再処理** (3分)
   ```
   操作: デスクトップに戻り、新しいノートを処理
   確認: モバイルで作成したノートが処理される
   期待: シームレスに動作する
   ```

**総所要時間**: 約15分

**成功基準**:
- ✅ デバイス間で正しく同期される
- ✅ データの整合性が保たれる
- ✅ マルチデバイスでの使用がスムーズ

---

## ユーザーペルソナ

### ペルソナ1: 田中さん（新規ユーザー）

- **年齢**: 35歳
- **職業**: プロジェクトマネージャー
- **Obsidian経験**: 3ヶ月
- **技術レベル**: 中級
- **ニーズ**: 大量のノートを整理したい
- **懸念**: 設定が複雑だと困る

### ペルソナ2: 佐藤さん（既存ユーザー）

- **年齢**: 28歳
- **職業**: ソフトウェアエンジニア
- **Obsidian経験**: 1年
- **技術レベル**: 上級
- **ニーズ**: 効率的なワークフロー
- **懸念**: 処理速度

### ペルソナ3: 山田さん（パワーユーザー）

- **年齢**: 42歳
- **職業**: 研究者
- **Obsidian経験**: 2年以上
- **技術レベル**: エキスパート
- **ニーズ**: 大規模データの処理
- **懸念**: パフォーマンスとカスタマイズ性

---

## 実行スクリプト

### スクリプト1: 初回セットアップ（15分）

```
[開始]
1. Obsidianを起動
2. 設定を開く
3. Community pluginsに移動
4. Personal Contextを有効化
5. Gemini API Keyを入力: [YOUR_KEY]
6. Auto Tagger設定:
   - Target directory: ""
   - Exclude note tag: "processed"
   - Exclude suggestion tags: "meta, system"
7. 保存
8. リボンアイコンをクリック
9. 「開始」ボタンをクリック
10. 処理完了を待つ
11. サマリーを確認
12. ノートを確認
13. ログファイルを確認
[完了]
```

### スクリプト2: 週次ルーティン（5分）

```
[開始]
1. Auto Taggerビューを開く
2. 「開始」ボタンをクリック
3. 対象ノート数を確認
4. 処理完了を待つ
5. サマリーを確認
6. 処理済みノートに`processed`タグを追加
[完了]
```

---

## まとめ

このE2Eテストシナリオ集は、実際のユーザーの使用パターンに基づいて設計されています。

**カバー範囲**:
- ✅ 新規ユーザーの初回体験
- ✅ 既存ユーザーの日常的な使用
- ✅ パワーユーザーの大規模処理
- ✅ エラーリカバリー
- ✅ カスタマイズ
- ✅ マルチデバイス使用

**次のステップ**:
1. 各シナリオを実行
2. ユーザー体験を評価
3. 改善点を特定
4. フィードバックを収集

---

**ドキュメントバージョン**: 1.0
**最終更新日**: 2025-10-11
